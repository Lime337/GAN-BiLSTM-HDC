`timescale 1ns / 1ps

module top_inference_wrapper (
    input  wire        clk,
    input  wire        rst_n,
    output reg  [15:0] sim_benign_reg,
    output reg  [15:0] sim_malware_reg,
    output reg         prediction_reg,
    output reg         logic_activity  // Dummy toggling output to simulate switching
);

    parameter D = 1024;
    parameter CHUNK = 10;

    // === Wires ===
    wire [CHUNK*D-1:0] input_lines_flat;
    wire [CHUNK*D-1:0] position_vectors_flat;
    wire [D-1:0] benign_class_vector;
    wire [D-1:0] malware_class_vector;
    wire [15:0] sim_benign;
    wire [15:0] sim_malware;
    wire        prediction;

    
    // === Hardcoded input data ===
    assign input_lines_flat = {
        1024'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111,
        1024'b0000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
        1024'b1111111111111111111111111111111100000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111,
        1024'b0000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000001111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
        1024'b1111111111111111111111111111111100000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,
        1024'b0000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000,
        1024'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111100000000000000000000000000000000,
        1024'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111100000000000000000000000000000000,
        1024'b0000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111,
        1024'b0000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111111111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000001111111111111111111111111111111111111111111111111111111111111111
    };

    assign position_vectors_flat = {
        1024'b1111001100011100010110111100100110000111000000101100101011001000111000100011011111001010101101000111110110101100111001000101000011001010000001100010111100001000100000110001101010010100101010011100101100100111110100100001101100111001001111011100011011000110000001011010111111110011000101010001110010110010000011101000000111110001100011010000111011100110111111110010101000111010000111000110111100001010101111111100111110111100111111101111110000010100101001110110110001010000100100110001011001111111011000000000111111100010011010101011110001110100010101001110010010000101100011000101001110110110001001010010101101001101111101111010000010011101101010101101001110000000100110010011000101110000111110100011000100111110101110111110101110101010010001010010101011010100001100010111001001100101011000111100101011101000110111111101110100001011011101010010001000001000010001000011000011000101011001100001101101000010011110000001101101001001000101011001010000101001101001010000111100001010111111010001000111110000101011110100111010100110,
        1024'b1111110000001001111101010110100011100101110010010001010010010010101010100010100101111011010111000001000001010100100001101011111100111000010100101010100000101001100100111011111110010101011101101001000101010010010001101010011111011100000010010001010010000111001101110001011011101001000001000001011111101111010100100000001101101101101000101101101100000000110101100111110001110100000101110001011111001010110111001000100110000000100011010100111100011111111011111101110000010010010110111100011001000011110100101100111110001111011110111000111000100100000011000111001110110001111000110110000010001111101110110110101101010001110100111001100010000011010100101111100011011010111110001100001011100110100011010111000100010101101010110010111001101110011001101010100110101010001110110100010101101100010010110111001110000111011111101111101010100100001111101110111001000000111011001100100101000011000000001111001010010010111000011111011001101011111101111010110001000010100000000011001011001000001100100111111011010100100101101110110100010000,
        1024'b0000110101001011110010100101101010101100000110100100010011000010011000011010000000010111100011100000000101100011011111111000101001101011001110101001010100010010001011001001111001101011111100111100000010100101100101100000011000011100011111101100011111110011110000101000111000100001001110000001010001110011101010101100111001100011101011001100000100101110000011011101101001001100110000010000100111100101111101111111000100001011010100100001101100110100111101101010000110111110011010011100111001110010111000010110110011010011100011001010001110000010100100001000010100100001000100000010100001110111100111010000110000000101110001011100001110010000010011011111110000011011010101010111111000011101000101111001010011001101001011101100001111111101100111011000010011001001000100100111111110001111001100000011101111010000100001100000111010000111000010110010001100101111111101001010011111101011011110110010110100101001010101111010111011110010010000110011010100101010011100100000101111111010000010011001101100101010001000111001101110000110,
        1024'b1100000010001101010000101100110001110111011001101111101000110011100001100100111011010100011101111000101110001011110110101011001100011000110111111111100000101010011001011110011001100001011110100000100111101010111010010001001100010000110111101001010001101010000111110111010110000000111111111011110011010111001000011001110100011010000000111000001100010101010111101011010000100010110100001110000011110011110111111000111000010011011010100010011001100101011001000000000000101010001011110000111000111001111110100000011100110000000100111101100101010101110110101111101001011110101001000101010101011100011010101011000100111011010010000001111000110111110001000101101011011000001010010111000111110011110011101000111001111001011111001111000011101110101001000100100000011111100001000011011111100000010000110001101000110011001101100011110001011010010011010101110100010100011011100000101011001001101101011000000000111110110011011000100110111011001001001111100100010000000000101010110110101011000011001101000101110110000011001011110010111001,
        1024'b0000101111010001100101111110101001100011110000111110110101101101011011110000000100101000101100101100010111001101111001011011010110101110010001101011100100100101111000111111101100110010010101010111011011100010101111001100111110101000010010100110000110111001110001000011000000010111111101001001110001110111000100101010010100101011111100001101011101001100111001011001110101011000110100100101100000001111001010011111110110111111001111110011101000100101010000100110100001110101111011110101111100010010011010101111111011111010011110001001001000100100001101011000010001110110100011000000110110010111110000001100101000101111001001001011110100001000111110001000101011110101100001110010110001100101100110000011001011001110001011110010101101011100100000111110010011110111100100101101000100011110000111001000001100001111000101110000010110011101011001010011000101111100100100101011011001111001111100101010011111111001101101010111100101100000001010001001001100111010001110010110011001010110111000011100010110100101011101000010100101111011,
        1024'b0010000001000010011100011111001011011001001001100011110111010000101010101100110000110000011000000110101101001010101100000100010010101000111111011011111000001110110001001101101001010111000010111011101101110110110101011010101011110011011011001100101000101000111110101001001100010110110101100100100000100110000000000000011100001010011101111101100110111011001001111010010100101101100101011000100101000010111001010001010101101011000011110111101010111010010000101000100011011110011110011011010001000101101101011110111101000111010000110001000010011011101010010110101010111000111100000111011100110110000111101111100100111000111101010000010110110101010101110110101001011001101011111011011010010011001010110010110110100100110011110011101011110011001110100110011010110001010110001001111111011000001111111100000111001000111010011111001010010011010100000111010000011111101011011101010110110010111101000111100110100000110010101100100111001100110100101001001000000100010100111111001000000111011100000110100010001000111000001010001110110110,
        1024'b1101111001110111111000101001110111111101101100000101110011000000111101001010110111000100011011111001010010000100000110101000011000011111001101000010001001110011110101100001010001000010100010110111001010001111111001001111000010100110010010010011001100011100110011111001111010001110011001111110000101011010101000001110111001000000111001000011001001000110011010000000100010001111100000000000011001010100000110001110111111100010011110111011100111011000110000111011011111100000000000011001110011111001010011011011111110100011100110100010101010010110000111010011001011011001110101111001010000101110011110011111010101000001110010100111110110000001000000011110001001100101100101110110101110000011001101000000001010100000100001010100001000100010010110111101011011110011101100000010011101100110101000100101101000011010111100010010011100101011001101011110010000000100001011101101011011101011101000111000101011001101111110100010100111010110110011011011011111101000110101110101110001001011100110100000101000001100011111100000010111010000,
        1024'b1001010001110100101110111010100110001111000111010011111101001011010100011000110010000000111110001101000001001100001001111111011100111110000010101010100100011100011000100101000110101011010101110000110100101111111010001101110010001100101101011010001011110001110011000110000110111000110001111000000011001100011011011011101000001100110101010100110001010000101000111011100011001010011001010111010100011100111100101010001101100010110110000010111001110001000010100010011100011110110100011000011110001010111100100010111100100100010101100001101110101100100100100110001000001111110001100110001110100010100111111001000010100011001011000000101110000000111110011100010011110011010100101111101011011111100011010111111100001101001101101001101100101111001011111100001101100111101010110010110100100100110110000111011111111010011000011110011101110011011100000011111011111110111101110010000110001110100101100011011010111000101101010110000110100001001101000100000001111011001111101011000101100111111011100101110000100101110001100101001111010010,
        1024'b1011001101011011010101111000100110000111100110001111000111111100001111011100001011001001101000000000110110010100101110101000001110111000101101110011001101110110101010111111100111010110110111011011010101110001001110001111011011010101001001101001001110111111011110000101010110000011010010010100100111110010111010001000101111000100001001001010001011011010100111000001100011100111110001011011100001000110011001100110011000111011000011101010010010110100011001001101101000001011000100100011100000100111010011100000001001110001001110111010111000110111110010101010111010001010000100000101011100101000100011101100000000011100110111010110101001000100011110000000101001011010111011110101100111100101100011111001110110110001011001010100100010100100001001000110000110010011110101000100011010001101010110010010100001001010111011111000000010010010110000111010110001110101011011000000010101101000010011010001010001010111000000110010111000101000011110011000110001000001011111001110000110110000100101100100010000000101100101000001111111111100,
        1024'b1011110011101011100110010001011000000010100011001110010011011011100010100010010110100111101110011000001000000111010011111110101100111011001011100011100111110101110101110010110010011000101010101010000101111001110100100010000111101011010110010101001100001000110011111100011000010001101010100110100010100110011110110111011000101100001010111011111011101001110100110000101000111010101000100001010011011100010110000000111010010100000000101010101001110110000010011101101101010000010110001111100110100010000000011100011111111100111111000000010010110101001001101010101111111111000001111101011010001111011100101100001110110110000011110101010001011011011101110101100001011011010111110001000011101011011000001011110110000111001001010000110101001011111011110011101000110001000100011101110011011111001001101101011000000011101110001011100010001101000111001000010101011101011100011111110011110101011000100101011011101100101011110011101000011110101110011001011010111010100101110101110101111000100010010100101100000000100111101000110101110110
     };

    assign benign_class_vector  = 1024'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000011111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001111111111111111111111111111111100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000111111111111111111111111111111110000000000000000000000000000000000000000000000000000000000000000;
    assign malware_class_vector = 1024'b0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000;

    // === Instantiate Core ===
    inference_core #(.D(D), .CHUNK(CHUNK)) infer_inst (
        .input_lines_flat(input_lines_flat),
        .position_vectors_flat(position_vectors_flat),
        .benign_class_vector(benign_class_vector),
        .malware_class_vector(malware_class_vector),
        .sim_benign(sim_benign),
        .sim_malware(sim_malware),
        .prediction(prediction)
    );

    // === Register Outputs ===
    always @(posedge clk or negedge rst_n) begin
        if (!rst_n) begin
            sim_benign_reg   <= 0;
            sim_malware_reg  <= 0;
            prediction_reg   <= 0;
            logic_activity   <= 0;
        end else begin
            sim_benign_reg   <= sim_benign;
            sim_malware_reg  <= sim_malware;
            prediction_reg   <= prediction;
            logic_activity   <= ~logic_activity;  // force toggle for switching activity
        end
    end


endmodule
